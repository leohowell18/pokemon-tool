<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pok√©mon Dual-Type Matchup Viewer</title>
  <style>
    :root {
      color-scheme: dark;
    }
    body {
      background-color: #1e1e1e;
      color: #eee;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      display: flex;
      justify-content: center;
      padding: 20px;
      box-sizing: border-box;
    }
    input[type="text"], select {
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid #666;
      background-color: #333;
      color: #eee;
      font-size: 1rem;
    }
    .container {
      background: #2c2c2c;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 800px;
    }
    h1 {
      text-align: center;
      margin-top: 0;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: flex-end;
      gap: 20px;
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid #444;
    }
    .selector-group {
      text-align: center;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 0.5rem;
    }
    #type-2-group {
      transition: all 0.3s ease;
    }
    #results-container {
      margin-top: 1rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 10px;
    }
    .result-item {
      padding: 10px 15px;
      border-radius: 6px;
      color: white;
      font-weight: 500;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      font-size: 0.95rem;
    }
    .result-item span:last-child {
      font-weight: bold;
    }
    .quad-effective { background-color: #4CAF50; }
    .super-effective { background-color: #8BC34A; }
    .normal-damage { background-color: #777; }
    .not-very-effective { background-color: #d9534f; }
    .quad-not-effective { background-color: #B71C1C; }
    .immune { background-color: #5bc0de; }
  </style>
</head>
<body>
<div class="container">
  <h1>Dual-Type Matchup Viewer</h1>
  <div class="controls">
    <div class="selector-group">
      <label for="mode">View Mode</label>
      <select id="mode">
        <option value="defending">Defensive Matchups</option>
        <option value="attacking">Offensive Matchups</option>
      </select>
    </div>
    <div class="selector-group">
      <label for="pokemonSelect">Choose a Pok√©mon</label>
      <input type="text" id="pokemonSelect" list="pokemonList" placeholder="Choose a Pok√©mon..." />
      <datalist id="pokemonList"></datalist>
    </div>
    <div class="selector-group">
      <label for="pokemon-type-1">Primary Type</label>
      <select id="pokemon-type-1"></select>
    </div>
    <div class="selector-group" id="type-2-group">
      <label for="pokemon-type-2">Secondary Type (Optional)</label>
      <select id="pokemon-type-2"></select>
    </div>
    <div class="selector-group">
      <label><input type="checkbox" id="hide-neutral"> Hide Neutral</label>
    </div>
  </div>
  <div id="results-container" role="region" aria-label="Matchup Results"></div>
</div>
<script>
let pokemonTypeMap = {};
const allTypes = ["Normal", "Fire", "Water", "Electric", "Grass", "Ice", "Fighting", "Poison", "Ground", "Flying", "Psychic", "Bug", "Rock", "Ghost", "Dragon", "Dark", "Steel", "Fairy"];
const typeChart = {/* omitted here for brevity */};

const modeSelect = document.getElementById('mode');
const type1Select = document.getElementById('pokemon-type-1');
const type2Select = document.getElementById('pokemon-type-2');
const type2Group = document.getElementById('type-2-group');
const resultsContainer = document.getElementById('results-container');
const hideNeutralCheckbox = document.getElementById('hide-neutral');
const pokemonInput = document.getElementById("pokemonSelect");

fetch("pokemon-types.json")
  .then(res => res.json())
  .then(data => {
    pokemonTypeMap = data;
    populateDropdowns();
    populateDatalistFromMap(pokemonTypeMap);
    updateView();
  });

function populateDropdowns() {
  type1Select.innerHTML = "";
  type2Select.innerHTML = `<option value="None">None</option>`;
  allTypes.forEach(type => {
    const option = `<option value="${type}">${type}</option>`;
    type1Select.innerHTML += option;
    type2Select.innerHTML += option;
  });
  type1Select.value = "Grass";
  type2Select.value = "None";
}

function populateDatalistFromMap(typeMap) {
  const datalist = document.getElementById("pokemonList");
  datalist.innerHTML = Object.keys(typeMap)
    .map(name => `<option value="${name}"></option>`)
    .join('');
}

pokemonInput.addEventListener("change", () => {
  const selected = pokemonInput.value.toLowerCase();
  const types = pokemonTypeMap[selected];
  if (types) {
    type1Select.value = types[0];
    type2Select.value = types[1] || "None";
    updateView();
  }
});

function getResultClassAndText(multiplier) {
  if (multiplier === 0) return { class: 'immune', text: '‚õî Immune (0x)' };
  if (multiplier === 0.25) return { class: 'quad-not-effective', text: 'üõ°Ô∏è Resists (0.25x)' };
  if (multiplier === 0.5) return { class: 'not-very-effective', text: 'üõ°Ô∏è Resists (0.5x)' };
  if (multiplier === 1) return { class: 'normal-damage', text: 'Normal (1x)' };
  if (multiplier === 2) return { class: 'super-effective', text: 'üî• Weak (2x)' };
  if (multiplier === 4) return { class: 'quad-effective', text: 'üî•üî• Weak (4x)' };
  return { class: 'normal-damage', text: `Neutral (${multiplier}x)` };
}

function createResultItem(typeLabel, effectiveness) {
  const div = document.createElement('div');
  div.className = `result-item ${effectiveness.class}`;
  div.innerHTML = `<span>${typeLabel}</span><span>${effectiveness.text}</span>`;
  return div;
}

function updateView() {
  const mode = modeSelect.value;
  const type1 = type1Select.value;
  const type2 = type2Select.value;
  const hideNeutral = hideNeutralCheckbox.checked;
  resultsContainer.innerHTML = '';
  if (mode === 'defending') {
    type2Group.style.display = 'block';
    type2Select.disabled = false;
    allTypes.forEach(attackingType => {
      const multiplier1 = typeChart[attackingType]?.[type1] ?? 1;
      const multiplier2 = type2 === 'None' ? 1 : (typeChart[attackingType]?.[type2] ?? 1);
      const finalMultiplier = multiplier1 * multiplier2;
      if (hideNeutral && finalMultiplier === 1) return;
      const effectiveness = getResultClassAndText(finalMultiplier);
      const label = `${attackingType} ‚Üí ${type2 === 'None' ? type1 : `${type1} / ${type2}`}`;
      resultsContainer.appendChild(createResultItem(label, effectiveness));
    });
  } else {
    type2Group.style.display = 'none';
    type2Select.disabled = true;
    const attackingType = type1;
    allTypes.forEach(defendingType => {
      const multiplier = typeChart[attackingType]?.[defendingType] ?? 1;
      if (hideNeutral && multiplier === 1) return;
      const effectiveness = getResultClassAndText(multiplier);
      const label = `${attackingType} ‚Üí ${defendingType}`;
      resultsContainer.appendChild(createResultItem(label, effectiveness));
    });
  }
}

modeSelect.addEventListener("change", updateView);
type1Select.addEventListener("change", updateView);
type2Select.addEventListener("change", updateView);
hideNeutralCheckbox.addEventListener("change", updateView);
</script>
</body>
</html>
