<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokémon Team Analyzer</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 2rem;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1, h2 { text-align: center; }
        h1 { margin-top: 0; }
        h2 { border-bottom: 1px solid #eee; padding-bottom: 10px; margin-top: 40px; }

        #team-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .team-slot input {
            width: 100%;
            padding: 10px;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 6px;
        }
        #analyze-btn-container {
            text-align: center;
            margin: 30px 0;
        }
        #analyze-btn {
            padding: 12px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            color: white;
            background-color: #d9534f;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #analyze-btn:hover { background-color: #c9302c; }
        #analyze-btn.loading { background-color: #777; cursor: not-allowed; }

        #results-output, #loader { text-align: center; }
        
        #team-summary {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 20px;
        }
        .summary-column {
            flex: 1;
            min-width: 280px;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
        }
        .summary-column h3 { margin-top: 0; }
        
        #individual-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        .pokemon-card {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
        }
        .pokemon-card h3 { margin-top: 0; }
        .type-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 4px;
            color: white;
            font-weight: 500;
            margin-right: 5px;
        }
        .matchup-list {
            list-style-type: none;
            padding: 0;
        }
        .matchup-list li {
            padding: 5px;
            margin-bottom: 5px;
            border-radius: 4px;
            color: white;
        }
        .weak-4x { background-color: #B71C1C; } /* Dark Red */
        .weak-2x { background-color: #d9534f; } /* Red */
        .resist-25x { background-color: #4CAF50; } /* Strong Green */
        .resist-50x { background-color: #8BC34A; } /* Lighter Green */
        .immune-0x { background-color: #5bc0de; } /* Blue */

    </style>
</head>
<body>

<div class="container">
    <h1>Pokémon Team Analyzer</h1>
    
    <div id="team-input-grid">
        </div>
    <datalist id="pokemon-list"></datalist>
    
    <div id="analyze-btn-container">
        <button id="analyze-btn" disabled>Loading Pokémon Data...</button>
    </div>

    <div id="results-output"></div>
</div>

<script>
// --- DATA AND CONFIGURATION ---
const POKEMON_DATA_URL = 'https://raw.githubusercontent.com/sindresorhus/pokemon/main/data/en.json';
const TYPE_CHART = {
    "Normal": {"Rock": 0.5, "Ghost": 0, "Steel": 0.5},
    "Fire": {"Fire": 0.5, "Water": 0.5, "Grass": 2, "Ice": 2, "Bug": 2, "Rock": 0.5, "Dragon": 0.5, "Steel": 2},
    "Water": {"Fire": 2, "Water": 0.5, "Grass": 0.5, "Ground": 2, "Rock": 2, "Dragon": 0.5},
    "Electric": {"Water": 2, "Electric": 0.5, "Grass": 0.5, "Ground": 0, "Flying": 2, "Dragon": 0.5},
    "Grass": {"Fire": 0.5, "Water": 2, "Grass": 0.5, "Poison": 0.5, "Ground": 2, "Flying": 0.5, "Bug": 0.5, "Rock": 2, "Dragon": 0.5, "Steel": 0.5},
    "Ice": {"Fire": 0.5, "Water": 0.5, "Grass": 2, "Ice": 0.5, "Ground": 2, "Flying": 2, "Dragon": 2, "Steel": 0.5},
    "Fighting": {"Normal": 2, "Ice": 2, "Poison": 0.5, "Flying": 0.5, "Psychic": 0.5, "Bug": 0.5, "Rock": 2, "Ghost": 0, "Dark": 2, "Steel": 2, "Fairy": 0.5},
    "Poison": {"Grass": 2, "Poison": 0.5, "Ground": 0.5, "Rock": 0.5, "Ghost": 0.5, "Steel": 0, "Fairy": 2},
    "Ground": {"Fire": 2, "Electric": 2, "Grass": 0.5, "Poison": 2, "Flying": 0, "Bug": 0.5, "Rock": 2, "Steel": 2},
    "Flying": {"Electric": 0.5, "Grass": 2, "Fighting": 2, "Bug": 2, "Rock": 0.5, "Steel": 0.5},
    "Psychic": {"Fighting": 2, "Poison": 2, "Psychic": 0.5, "Dark": 0, "Steel": 0.5},
    "Bug": {"Fire": 0.5, "Grass": 2, "Fighting": 0.5, "Poison": 0.5, "Flying": 0.5, "Psychic": 2, "Ghost": 0.5, "Dark": 2, "Steel": 0.5, "Fairy": 0.5},
    "Rock": {"Fire": 2, "Ice": 2, "Fighting": 0.5, "Ground": 0.5, "Flying": 2, "Bug": 2, "Steel": 0.5},
    "Ghost": {"Normal": 0, "Psychic": 2, "Ghost": 2, "Dark": 0.5},
    "Dragon": {"Dragon": 2, "Steel": 0.5, "Fairy": 0},
    "Dark": {"Fighting": 0.5, "Psychic": 2, "Ghost": 2, "Dark": 0.5, "Fairy": 0.5},
    "Steel": {"Fire": 0.5, "Water": 0.5, "Electric": 0.5, "Ice": 2, "Rock": 2, "Steel": 0.5, "Fairy": 2},
    "Fairy": {"Fire": 0.5, "Fighting": 2, "Poison": 0.5, "Dragon": 2, "Dark": 2, "Steel": 0.5}
};
const ALL_TYPES = Object.keys(TYPE_CHART);
const TYPE_COLORS = { "Normal": "#A8A77A", "Fire": "#EE8130", "Water": "#6390F0", "Electric": "#F7D02C", "Grass": "#7AC74C", "Ice": "#96D9D6", "Fighting": "#C22E28", "Poison": "#A33EA1", "Ground": "#E2BF65", "Flying": "#A98FF3", "Psychic": "#F95587", "Bug": "#A6B91A", "Rock": "#B6A136", "Ghost": "#735797", "Dragon": "#6F35FC", "Dark": "#705746", "Steel": "#B7B7CE", "Fairy": "#D685AD" };
let pokemonList = [];

// --- INITIALIZATION ---
document.addEventListener('DOMContentLoaded', async () => {
    setupTeamInputs();
    const analyzeBtn = document.getElementById('analyze-btn');
    try {
        const response = await fetch(POKEMON_DATA_URL);
        pokemonList = await response.json();
        populateDatalist(pokemonList);
        analyzeBtn.disabled = false;
        analyzeBtn.textContent = 'Analyze Team';
    } catch (error) {
        console.error('Failed to load Pokémon data:', error);
        analyzeBtn.textContent = 'Error loading data. Please refresh.';
    }

    analyzeBtn.addEventListener('click', analyzeTeam);
});

function setupTeamInputs() {
    const grid = document.getElementById('team-input-grid');
    for (let i = 1; i <= 6; i++) {
        const slot = document.createElement('div');
        slot.className = 'team-slot';
        slot.innerHTML = `<input type="text" id="pokemon-${i}" list="pokemon-list" placeholder="Pokémon ${i}">`;
        grid.appendChild(slot);
    }
}

function populateDatalist(list) {
    const datalist = document.getElementById('pokemon-list');
    list.forEach(pokemon => {
        datalist.innerHTML += `<option value="${pokemon.name}">`;
    });
}


// --- ANALYSIS LOGIC ---
function getPokemonByName(name) {
    if (!name) return null;
    return pokemonList.find(p => p.name.toLowerCase() === name.toLowerCase());
}

function calculateDefensiveProfile(types) {
    const profile = { weaknesses: [], resistances: [], immunities: [] };
    if (!types || types.length === 0) return profile;

    ALL_TYPES.forEach(attackingType => {
        const multiplier1 = TYPE_CHART[attackingType]?.[types[0]] ?? 1;
        const multiplier2 = types.length > 1 ? (TYPE_CHART[attackingType]?.[types[1]] ?? 1) : 1;
        const finalMultiplier = multiplier1 * multiplier2;

        if (finalMultiplier >= 2) profile.weaknesses.push({ type: attackingType, multiplier: finalMultiplier });
        else if (finalMultiplier > 0 && finalMultiplier <= 0.5) profile.resistances.push({ type: attackingType, multiplier: finalMultiplier });
        else if (finalMultiplier === 0) profile.immunities.push({ type: attackingType });
    });
    return profile;
}

function analyzeTeam() {
    const team = [];
    for (let i = 1; i <= 6; i++) {
        const input = document.getElementById(`pokemon-${i}`);
        const pokemon = getPokemonByName(input.value);
        if (pokemon) {
            team.push(pokemon);
        }
    }
    
    if (team.length === 0) {
        document.getElementById('results-output').innerHTML = `<p>Please enter at least one Pokémon to analyze.</p>`;
        return;
    }

    renderResults(team);
}

// --- RENDERING RESULTS ---
function renderResults(team) {
    const output = document.getElementById('results-output');
    output.innerHTML = ''; // Clear previous results

    // 1. Team-wide analysis
    const teamWeaknessCounts = {};
    const teamResistanceCounts = {};
    ALL_TYPES.forEach(t => { 
        teamWeaknessCounts[t] = 0;
        teamResistanceCounts[t] = 0;
    });

    team.forEach(pokemon => {
        const profile = calculateDefensiveProfile(pokemon.types);
        profile.weaknesses.forEach(w => teamWeaknessCounts[w.type]++);
        profile.resistances.forEach(r => teamResistanceCounts[r.type]++);
        profile.immunities.forEach(i => teamResistanceCounts[i.type]++);
    });
    
    let teamSummaryHTML = `
        <h2>Team-Wide Analysis</h2>
        <div id="team-summary">
            <div class="summary-column">
                <h3>Common Weaknesses</h3>
                <ul class="matchup-list">${generateSummaryList(teamWeaknessCounts, 'weak')}</ul>
            </div>
            <div class="summary-column">
                <h3>Common Resistances</h3>
                <ul class="matchup-list">${generateSummaryList(teamResistanceCounts, 'resist')}</ul>
            </div>
        </div>
    `;
    output.innerHTML += teamSummaryHTML;

    // 2. Individual analysis
    let individualResultsHTML = '<h2>Individual Pokémon</h2><div id="individual-results">';
    team.forEach(pokemon => {
        const profile = calculateDefensiveProfile(pokemon.types);
        individualResultsHTML += `
            <div class="pokemon-card">
                <h3>${pokemon.name}</h3>
                <p>${pokemon.types.map(t => `<span class="type-badge" style="background-color:${TYPE_COLORS[t]}">${t}</span>`).join(' ')}</p>
                
                <h4>Defensive Matchups:</h4>
                <ul class="matchup-list">
                    ${profile.weaknesses.map(w => `<li class="weak-${w.multiplier === 4 ? '4x' : '2x'}">${w.type} (x${w.multiplier})</li>`).join('')}
                    ${profile.resistances.map(r => `<li class="resist-${r.multiplier === 0.25 ? '25x' : '50x'}">${r.type} (x${r.multiplier})</li>`).join('')}
                    ${profile.immunities.map(i => `<li class="immune-0x">${i.type} (x0)</li>`).join('')}
                </ul>
            </div>
        `;
    });
    individualResultsHTML += '</div>';
    output.innerHTML += individualResultsHTML;
}

function generateSummaryList(counts, mode) {
    const filtered = Object.entries(counts)
        .filter(([type, count]) => count > (mode === 'weak' ? 1 : 2) ) // Show weaknesses shared by 2+ members, resistances by 3+
        .sort(([, countA], [, countB]) => countB - countA);
    
    if (filtered.length === 0) {
        return `<li>No significant overlapping ${mode === 'weak' ? 'weaknesses' : 'resistances'}.</li>`;
    }

    return filtered.map(([type, count]) => {
        const className = mode === 'weak' ? 'weak-2x' : 'resist-50x';
        return `<li class="${className}">${type} (${count} members)</li>`
    }).join('');
}

</script>
</body>
</html>